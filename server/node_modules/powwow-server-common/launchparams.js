/**
 * To run powwow-server-common, call "node start.js".  The following <b>launch parameters</b> can be passed in:
 */
var minimist = require('minimist');
var argv = minimist(process.argv.slice(2));

if (argv.hasOwnProperty('sessionID')) {
    /**
     * --sessionID <sessionID to register with App Server>
     */
    exports.sessionID = argv.sessionID;
}

if (argv.hasOwnProperty('port')) {
    /**
     * --port <integer>: Port to listen on 
     */
    exports.port = argv.port;
}

if (argv.hasOwnProperty('persistlogs')) {
    /**
     * --persistlogs: Indicates that logs should be persisted in the folder where the transform process runs.
     *                Format of logs is "dev-YYYY-MM-DD-HH.mm.ss-SSS-pid.log".
     */
    exports.persistlogs = true;
}

if (argv.hasOwnProperty('httpServerUrl')) {
    /**
     * --httpServerUrl <string>: URL of the httpServer that this process is listening on.
     */
    exports.httpServerUrl = argv.httpServerUrl;
}

if (argv.hasOwnProperty('cookies')) {
    var cookies = JSON.parse(new Buffer(argv.cookies, 'base64').toString());
    for (var c=0; c < cookies.length; c++) {
        if (cookies[c].expires === -1) {
            delete cookies[c].expires;
        }
    }

    /**
     * --cookies <base64 encoded cookies.  Format expected is:
     *             base64(
     *             [
     *               {
     *                 name: string,
     *                 value: string,
     *                 domain: string,
     *                 path: string,
     *                 httponly: boolean,
     *                 secure: boolean,
     *                 expires: integer  #ms  Life of cookie. May be -1.
     *              }
     *             ]) 
     */
    exports.cookies = cookies;
}
